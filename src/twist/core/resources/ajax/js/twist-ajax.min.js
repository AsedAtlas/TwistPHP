/**
 * Twist AJAX 3.0.0 | Andrew Hosgood - 12/05/2014
 */
try{if($){(function(e,t,n){var r=function(e,t,n){n=typeof n==="boolean"?n:false;if(n){return t.indexOf(e)!==-1}else{return t.toLowerCase().indexOf(e.toLowerCase())!==-1}},i=function(e){return e.replace(/[\s\t\r\n]*/g,"")==""},s=function(e){return navigator.userAgent.indexOf("MSIE ")};isNull=function(e){return typeof e==="null"||e===null},isSet=function(e){return e!==null&&e!==undefined&&typeof e!=="null"&&typeof e!=="undefined"&&e!=="undefined"},log=function(){var t=arguments;if(isSet(e.console)&&isSet(e.console.log)&&t.length>0){for(var n in t){e.console.log(t[n])}}},objectLength=function(e){var t=0;if(typeof e==="object"){for(var n in e){if(s()&&Object.prototype.hasOwnProperty.call(e,n)||e.hasOwnProperty(n)){t++}}}return t},prettySize=function(e,t){var n=["B","kB","MB","GB","TB","PB","EB","ZB","YB"];var r=0;while(n[r]&&e>Math.pow(1024,r+1)){r++}return round(e/Math.pow(1024,r),2)+(typeof t==="boolean"&&t?" ":"")+n[r]},round=function(e,t){t=typeof t!=="number"?0:t;return t===0?parseInt(Math.round(e*Math.pow(10,t))/Math.pow(10,t)):parseFloat(Math.round(e*Math.pow(10,t))/Math.pow(10,t))};var o=function(s,o,u,a,f,l){var c=function(){},h=function(){},p={},d=1e4,v="medium",m={};if(typeof s!=="string"||s==""){throw new Error("Need to specify a valid AJAX post location")}if(typeof o==="function"){c=o;if(typeof u==="function"){h=u;if(typeof a==="object"){p=a;if(typeof f==="number"){d=f;if(typeof l==="string"){v=l}}else if(typeof f==="string"){v=f}}else if(typeof a==="number"){d=a;if(typeof f==="string"){v=f}}else if(typeof a==="string"){v=a}}else if(u==="object"){p=u;if(typeof a==="number"){d=a;if(typeof f==="string"){v=f}}else if(typeof a==="string"){v=a}}else if(u==="number"){d=u;if(typeof a==="string"){v=a}}else if(typeof u==="string"){v=u}}else if(typeof o==="object"){p=o;if(typeof u==="number"){d=u;if(typeof a==="string"){v=a}}else if(typeof u==="string"){v=u}}else if(typeof o==="number"){d=o;if(typeof u==="string"){v=u}}else if(typeof o==="string"){v=o}n.ajaxSetup({url:s,timeout:d});var g=this;this.count=0,this.defaultArray=p,this.disableLoader=function(){g.showLoader=false;return g},this.enableLoader=function(){g.showLoader=true;return g},this.loaderSize=function(e){if(n("#twist-ajax-loader").length){n("#twist-ajax-loader").attr("class","").addClass(e)}v=e;return g},this.onfail=function(e,t){var n=typeof e==="string"&&e!==""?e:"An unexpected AJAX response was given";log(n);return g},this.send=function(e,t,r,i,o){g.count++;n("#twist-ajax-loader-size").text("Loading...");if(g.count>1){n("#twist-ajax-loader-count").text(g.count)}if(g.showLoader){n("#twist-ajax-loader").stop().show().fadeTo(0,1)}var u={foo:"bar"},a=d,f=function(){},l=function(){};if(typeof t==="object"||typeof t==="string"&&/^\#[0-9a-z_\-]+$/i.test(t)&&(n(t)instanceof jQuery||t.jquery)){if(typeof t==="object"){if(t instanceof jQuery||t.jquery){u=g.serializeJSON(t)}else{u=objectLength(t)===0?u:t}}else{u=g.serializeJSON(n(t))}if(typeof r==="number"){a=r;if(typeof i==="function"){f=i;if(typeof o==="function"){l=o}}}else if(typeof r==="function"){f=r;if(typeof i==="function"){l=i}}}else if(typeof t==="number"){a=t;if(typeof r==="function"){f=r;if(typeof i==="function"){l=i}}}else if(typeof t==="function"){f=t;if(typeof r==="function"){l=r}}var p=function(e){try{f.call(e);c.call(e)}catch(t){log(t)}},v=function(e){try{l.call(e);h.call(e)}catch(t){log(t)}};var m={"function":e,data:u};n.each(g.defaultArray,function(e,t){m[e]=t});var y=(new Date).getTime(),b=n.ajax({type:"POST",url:s,data:m,dataType:"json",timeout:a,global:true,cache:false,complete:function(e,t){g.count--;if(g.count===0){n("#twist-ajax-loader").stop().fadeTo(200,0,function(){n(this).hide()})}else{n("#twist-ajax-loader-count").text(g.count>1?g.count:"")}},success:function(e,t,r){var i=prettySize(r.getResponseHeader("Content-Length"));n("#twist-ajax-loader-size").text("Downloading "+i+"...");if(!isNull(e)&&typeof e==="object"&&isSet(e.status)&&e.status===true){p(e)}else{v(e)}},error:function(t,r,i){switch(r){case"abort":v();n("#twist-ajax-loader-size").text("Aborted");log("The AJAX request was aborted");break;case"timeout":v();n("#twist-ajax-loader-size").text("Timeout");log("The AJAX request timed out");break;case"parsererror":var o=/{"status":(true|false),"message":"[^"]*","title":"[^"]*","data":({.*}|\[\])(,"[^"]+":(true|false|("[^"]*")|({.*}|\[\])))*,"sticky":(true|false),"importance":\d+,"loggedin":(true|false),"login_redirect":(true|false),"output":"[^"]*"}/,u=prettySize(t.getResponseHeader("Content-Length")),f="==============================================================================================",l=typeof JSON!=="undefined"?"\nPost              "+JSON.stringify(m):"";log(f+"\nDate              "+t.getResponseHeader("Date")+"\nLocation          "+s+"\nFunction          "+e+"\nTimeout           "+a/1e3+"s\nResponse length   "+u+l+"\n"+f+"\n"+t.responseText.replace(o,""));if(t.responseText.match(o)){var c=t.responseText.match(o)[0];if(n.parseJSON(c)!==null){var h=n.parseJSON(c);if(typeof h==="object"&&"status"in h&&h.status===true){p(h)}else{v(h)}}else{v();try{g.onfail(i)}catch(d){log(d)}}}else{v();try{g.onfail(i)}catch(d){log(d)}}break;case"error":default:v();n("#twist-ajax-loader-size").text("Error");try{g.onfail(i)}catch(d){log(d)}break}}});return g},this.serializeJSON=function(e){var t={},s=[];jQuery.map(e.serializeArray(),function(e,t){s.push({name:e.name,value:e.value})}),e.find('input[type="submit"][name][value], input[type="reset"][name][value], input[type="button"][name][value], button[name][value]').each(function(){var e=n(this);s.push({name:e.attr("name"),value:e.val()})});var o=function(e,t,u,a){var f={},l=u.match(/^(\[([^\[]*)\])((\[[^\[]*\])*)$/i);if(l){var c=l[2];if(i(c)){var h=1,p=true;do{var d=true;n.each(s,function(e,n){if(r(t+"["+h+"]",n.name)){h++;d=false}});if(d){var v=false;n.each(s,function(e,n){if(!v&&n.name===t+"[]"&&n.value===a){s[e].name=t+"["+h+"]";v=true}});p=false}}while(p);c=h}if(l[3]){f[c]=o(e,t+"["+c+"]",l[3],a)}else{f[c]=a}}return f};n.each(s,function(e,r){var i=r.name.match(/^([^\[]+)((\[[^\[]*\])+)$/i);if(i){var s={};s[i[1]]=o(r.name,i[1],i[2],r.value);t=n.extend(true,t,s)}else{t[r.name]=r.value}});return t},this.showLoader=true;n(t).ready(function(){n("body").prepend('<div id="twist-ajax-loader" class="'+v+'"><span id="twist-ajax-loader-count"></span><span id="twist-ajax-loader-size"></span></div>')});e.TwistAJAXSessions.push(this);return true};e.TwistAJAX=function(e,t,n,r){return new o(e,t,n,r)};if(!e.TwistAJAXSessions){e.TwistAJAXSessions=[]}})(window,document,jQuery)}else{throw"Twist AJAX requires jQuery to run"}}catch(err){if(window.console&&window.console.log){console.log(err)}}