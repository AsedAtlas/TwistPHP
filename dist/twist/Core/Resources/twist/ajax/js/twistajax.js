!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.twistajax=t()}(this,function(){"use strict";function e(e){var t=[],n=/^([^\[\]]*)/,o=new RegExp(a),r=n.exec(e);for(r[1]&&t.push(r[1]);null!==(r=o.exec(e));)t.push(r[1]);return t}function t(e,n,o){if(0===n.length)return e=o;var r=n.shift(),i=r.match(/^\[(.+?)\]$/);if("[]"===r)return e=e||[],Array.isArray(e)?e.push(t(null,n,o)):(e._values=e._values||[],e._values.push(t(null,n,o))),e;if(i){var u=i[1],c=+u;isNaN(c)?(e=e||{})[u]=t(e[u],n,o):(e=e||[])[c]=t(e[c],n,o)}else e[r]=t(e[r],n,o);return e}function n(n,o,r){if(o.match(a))t(n,e(o),r);else{var i=n[o];i?(Array.isArray(i)||(n[o]=[i]),n[o].push(r)):n[o]=r}return n}function o(e,t,n){return n=n.replace(/(\r)?\n/g,"\r\n"),n=encodeURIComponent(n),n=n.replace(/%20/g,"+"),e+(e?"&":"")+encodeURIComponent(t)+"="+n}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=/^(?:submit|button|image|reset|file)$/i,c=/^(?:input|select|textarea|keygen)/i,a=/(\[[^\[\]]*\])/g,s=function(e,t){"object"!=(void 0===t?"undefined":i(t))?t={hash:!!t}:void 0===t.hash&&(t.hash=!0);for(var r=t.hash?{}:"",a=t.serializer||(t.hash?n:o),s=e&&e.elements?e.elements:[],l=Object.create(null),f=0;f<s.length;++f){var h=s[f];if((t.disabled||!h.disabled)&&h.name&&c.test(h.nodeName)&&!u.test(h.type)){var p=h.name,y=h.value;if("checkbox"!==h.type&&"radio"!==h.type||h.checked||(y=void 0),t.empty){if("checkbox"!==h.type||h.checked||(y=""),"radio"===h.type&&(l[h.name]||h.checked?h.checked&&(l[h.name]=!0):l[h.name]=!1),void 0==y&&"radio"==h.type)continue}else if(!y)continue;if("select-multiple"!==h.type)r=a(r,p,y);else{y=[];for(var d=h.options,m=!1,v=0;v<d.length;++v){var b=d[v],g=t.empty&&!b.value,k=b.value||g;b.selected&&k&&(m=!0,r=t.hash&&"[]"!==p.slice(p.length-2)?a(r,p+"[]",b.value):a(r,p,b.value))}!m&&t.empty&&(r=a(r,p,""))}}}if(t.empty)for(var p in l)l[p]||(r=a(r,p,""));return r},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();return function(){function e(t){r(this,e),this.uri=t.replace(/\/$/,""),this.timeout=1e4,this.cache=!1,this.requests=0,this.debug=!1,this.preSuccess=function(e){return e}}return l(e,[{key:"get",value:function(e){return this.send(e,{},"GET")}},{key:"post",value:function(e,t){return this.send(e,t,"POST")}},{key:"postForm",value:function(e,t){var n=s(document.querySelector(t),{empty:!0});return console.log(n),this.post(e,n)}},{key:"send",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return console.log(n),new Promise(function(r,i){fetch(t.uri+"/"+e,{method:o,headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(n),cache:t.cache?"default":"no-store"}).then(function(e){return e.json()}).then(function(e){return"function"==typeof t.preSuccess?t.preSuccess(e):e}).then(function(e){if(!0!==e.status)throw e.message||"Status returned FALSE";return e.data}).then(function(e){return r(e)}).catch(function(e){i(e)})})}},{key:"serialise",value:function(e){return s(e)}},{key:"timeout",set:function(e){console.log("Changed timeout to "+e)}}]),e}()});
//# sourceMappingURL=twistajax.js.map
