!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.twistajax=t()}(this,function(){"use strict";function e(e){var t=[],n=/^([^\[\]]*)/,o=new RegExp(a),r=n.exec(e);for(r[1]&&t.push(r[1]);null!==(r=o.exec(e));)t.push(r[1]);return t}function t(e,n,o){if(0===n.length)return e=o;var r=n.shift(),i=r.match(/^\[(.+?)\]$/);if("[]"===r)return e=e||[],Array.isArray(e)?e.push(t(null,n,o)):(e._values=e._values||[],e._values.push(t(null,n,o))),e;if(i){var u=i[1],s=+u;isNaN(s)?(e=e||{})[u]=t(e[u],n,o):(e=e||[])[s]=t(e[s],n,o)}else e[r]=t(e[r],n,o);return e}function n(n,o,r){if(o.match(a))t(n,e(o),r);else{var i=n[o];i?(Array.isArray(i)||(n[o]=[i]),n[o].push(r)):n[o]=r}return n}function o(e,t,n){return n=n.replace(/(\r)?\n/g,"\r\n"),n=encodeURIComponent(n),n=n.replace(/%20/g,"+"),e+(e?"&":"")+encodeURIComponent(t)+"="+n}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=/^(?:submit|button|image|reset|file)$/i,s=/^(?:input|select|textarea|keygen)/i,a=/(\[[^\[\]]*\])/g,c=function(e,t){"object"!=(void 0===t?"undefined":i(t))?t={hash:!!t}:void 0===t.hash&&(t.hash=!0);for(var r=t.hash?{}:"",a=t.serializer||(t.hash?n:o),c=e&&e.elements?e.elements:[],l=Object.create(null),f=0;f<c.length;++f){var h=c[f];if((t.disabled||!h.disabled)&&h.name&&s.test(h.nodeName)&&!u.test(h.type)){var p=h.name,d=h.value;if("checkbox"!==h.type&&"radio"!==h.type||h.checked||(d=void 0),t.empty){if("checkbox"!==h.type||h.checked||(d=""),"radio"===h.type&&(l[h.name]||h.checked?h.checked&&(l[h.name]=!0):l[h.name]=!1),void 0==d&&"radio"==h.type)continue}else if(!d)continue;if("select-multiple"!==h.type)r=a(r,p,d);else{d=[];for(var y=h.options,v=!1,m=0;m<y.length;++m){var g=y[m],b=t.empty&&!g.value,k=g.value||b;g.selected&&k&&(v=!0,r=t.hash&&"[]"!==p.slice(p.length-2)?a(r,p+"[]",g.value):a(r,p,g.value))}!v&&t.empty&&(r=a(r,p,""))}}}if(t.empty)for(var p in l)l[p]||(r=a(r,p,""));return r},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();return function(){function e(t){r(this,e),this.uri=t.replace(/\/$/,""),this.timeout=1e4,this.cache=!1,this.requests=0,this.debug=!1}return l(e,[{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.send(e,t,"DELETE")}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.send(e,t,"GET")}},{key:"patch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.send(e,t,"PATCH")}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.send(e,t,"POST")}},{key:"put",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.send(e,t,"PUT")}},{key:"postForm",value:function(e,t){var n=c(document.querySelector(t),{empty:!0});return this.post(e,n)}},{key:"send",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return console.info("Requests: "+this.requests),new Promise(function(r,i){t.requests++,fetch(t.uri+"/"+e,{method:o,headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(n),cache:t.cache?"default":"no-store"}).then(function(e){return e.json()}).then(function(e){if(t.requests--,console.info("Requests: "+t.requests),!0!==e.status)throw e.message||"Status returned FALSE";return e.data}).then(function(e){return r(e)}).catch(function(e){i(e)})})}},{key:"debug",set:function(e){if(e){try{var t=["%c %c %c TwistPHP AJAX %c %c ","font-size: 15px; background: #2a5200;","font-size: 17px; background: #3f7a00;","color: #FFF; font-size: 18px; background: #539F00;","font-size: 17px; background: #3f7a00;","font-size: 15px; background: #2a5200;"];console.log.apply(console,t)}catch(e){console.info?console.info("TwistPHP AJAX"):console.log("TwistPHP AJAX")}var n={uri:this.uri,timeout:this.timeout,cache:this.cache,requests:this.requests};console.log(n)}}}]),e}()});
//# sourceMappingURL=twistajax.js.map
