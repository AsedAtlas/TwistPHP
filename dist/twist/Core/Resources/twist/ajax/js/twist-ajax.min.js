!function(t,e){"function"==typeof define&&define.amd?define("twistajax",["postal"],function(n){return t.twistajax=e(n)}):"object"==typeof module&&module.exports?module.exports=t.twistajax=e(require("postal")):t.twistajax=e(t.postal)}(this,function(t){try{if(window.jQuery){var e=function(t,e,n,o,r,a){var i=this,s=!1,u=function(t,e,n){return n="boolean"==typeof n?n:!1,n?-1!==e.indexOf(t):-1!==e.toLowerCase().indexOf(t.toLowerCase())},f=function(t,e){return p()&&Object.prototype.hasOwnProperty.call(t,e)||t.hasOwnProperty(e)},c=function(t){return""===t.replace(/[\s\t\r\n]*/g,"")},p=function(){return navigator.userAgent.indexOf("MSIE ")},l=function(){s&&d(arguments)},d=function(){var t=arguments;if(window.twistdebug&&t.length>0)for(var e in t)window.twistdebug.error(t[e]);else if(window.console&&window.console.log&&t.length>0)for(var n in t)window.console.log(t[n])},w=function(t){var e=0;if("object"==typeof t)for(var n in t)f(t,n)&&e++;return e},y=function(t,e){for(var n=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],o=0;n[o]&&t>Math.pow(1024,o+1);)o++;return h(t/Math.pow(1024,o),2)+("boolean"==typeof e&&e?" ":"")+n[o]},h=function(t,e){return e="number"!=typeof e?0:e,0===e?parseInt(Math.round(t*Math.pow(10,e))/Math.pow(10,e)):parseFloat(Math.round(t*Math.pow(10,e))/Math.pow(10,e))},m=function(t,e,n,o){var r={},a=n.match(/^(\[([^\[]*)\])((\[[^\[]*\])*)$/i);if(a){var i=a[2];if(c(i)){var s=1,f=!0;do{var p=!0;for(var l in arrFormElements)u(e+"["+s+"]",arrFormElements[l].name)&&(s++,p=!1);if(p){var d=!1;for(var w in arrFormElements)d||arrFormElements[w].name!==e+"[]"||arrFormElements[w].value!==o||(arrFormElements[w].name=e+"["+s+"]",d=!0);f=!1}}while(f);i=s}a[3]?r[i]=m(t,e+"["+i+"]",a[3],o):r[i]=o}return r},g=function(t){var e={},n=[];return jQuery.map(t.serializeArray(),function(t,e){n.push({name:t.name,value:t.value})}),t.find('input[type="submit"][name][value], input[type="reset"][name][value], input[type="button"][name][value], button[name][value]').each(function(){var t=$(this);n.push({name:t.attr("name"),value:t.val()})}),$.each(n,function(t,n){var o=n.name.match(/^([^\[]+)((\[[^\[]*\])+)$/i);if(o){var r={};r[o[1]]=m(n.name,o[1],o[2],n.value),e=$.extend(!0,e,r)}else e[n.name]=n.value}),e},b=function(){},v=function(){},j={},x=1e4,A="medium",E=!1,R=!0,O=function(e,n,o,r,a,s,u){i.count++,n="string"==typeof n?n:"POST",$("#twist-ajax-loader-size").text("Loading..."),i.count>1&&$("#twist-ajax-loader-count").text(i.count),R&&$("#twist-ajax-loader").stop().show().fadeTo(0,1);var c={},p=x,h=function(){},m=function(){};"object"==typeof r||"string"==typeof r&&/^\#[0-9a-z_\-]+$/i.test(r)&&($(r)instanceof jQuery||r.jquery)?(c="object"==typeof r?r instanceof jQuery||r.jquery?g(r):0===w(r)?c:r:g($(r)),"number"==typeof a?(p=a,"function"==typeof s&&(h=s,"function"==typeof u&&(m=u))):"function"==typeof a&&(h=a,"function"==typeof s&&(m=s))):"number"==typeof r?(p=r,"function"==typeof a&&(h=a,"function"==typeof s&&(m=s))):"function"==typeof r&&(h=r,"function"==typeof a&&(m=a)),$.each(i.defaultArray,function(t,e){c.data[t]=e});var j=t+"/"+e.replace(/^\//,""),A={type:n.toUpperCase(),url:j,data:c,dataType:"json",timeout:p,global:!0,cache:o,complete:function(t,e){i.count--,0===i.count?$("#twist-ajax-loader").stop().fadeTo(200,0,function(){$(this).hide()}):$("#twist-ajax-loader-count").text(i.count>1?i.count:"")},success:function(t,e,n){var o=y(n.getResponseHeader("Content-Length"));$("#twist-ajax-loader-size").text("Downloading "+o+"..."),t&&"object"==typeof t&&f(t,"status")&&t.status===!0?E(t,A):O(t,A)},error:function(t,e,n){switch(e){case"abort":O({},A),$("#twist-ajax-loader-size").text("Aborted"),l("The AJAX request was aborted");break;case"timeout":O({},A),$("#twist-ajax-loader-size").text("Timeout"),l("The AJAX request timed out");break;case"parsererror":var o=/{"status":(true|false),"message":"[^"]*","data":({.*}|\[\])(,"[^"]+":(true|false|("[^"]*")|({.*}|\[\])))*(,"debug":({.*}|\[\])(,"[^"]+":(true|false|("[^"]*")|({.*}|\[\])))*)?}/,r=y(t.getResponseHeader("Content-Length")),a="===============================================";if(o.test(t.responseText)){d(window.twistdebug?a+"<br>PARSER ERROR RECOVERY<br>"+a+"<br>Date:             "+t.getResponseHeader("Date")+"<br>Location:         "+j+"<br>Timeout:          "+p/1e3+"s<br>Response length:  "+r+("undefined"!=typeof JSON?"<br>Post data:        "+JSON.stringify(c):"{}")+"<br>"+a:a+"\nPARSER ERROR RECOVERY\n"+a+"\nDate:             "+t.getResponseHeader("Date")+"\nLocation:         "+j+"\nTimeout:          "+p/1e3+"s\nResponse length:  "+r+("undefined"!=typeof JSON?"\nPost data:        "+JSON.stringify(c):"{}")+"\n"+a);var s=t.responseText.match(o)[0];if(null!==$.parseJSON(s)){var u=$.parseJSON(s);"object"==typeof u&&"status"in u&&u.status===!0?E(u,A):O(u,A)}else{O({},A);try{i.onfail(n)}catch(f){l(f)}}}else{d("Parse error"),O({},A);try{i.onfail(n)}catch(f){l(f)}}break;default:O({},A),$("#twist-ajax-loader-size").text("Error");try{i.onfail(n)}catch(f){l(f)}}}},E=function(t,e){try{h.call(t,e),b.call(t,e),window.twistdebug&&window.twistdebug.logAJAX(!0,t,e)}catch(n){l(n)}},O=function(t,e){try{m.call(t,e),v.call(t,e),window.twistdebug&&window.twistdebug.logAJAX(!1,t,e)}catch(n){l(n)}};return $.ajax(A)};if("string"!=typeof t||""===t)throw new Error("Please specify an AJAX URI");return t=t.replace(/\/$/,""),"function"==typeof e?(b=e,"function"==typeof n?(v=n,"object"==typeof o?(j=o,"number"==typeof r?(x=r,"string"==typeof a&&(A=a)):"string"==typeof r&&(A=r)):"number"==typeof o?(x=o,"string"==typeof r&&(A=r)):"string"==typeof o&&(A=o)):"object"===n?(j=n,"number"==typeof o?(x=o,"string"==typeof r&&(A=r)):"string"==typeof o&&(A=o)):"number"===n?(x=n,"string"==typeof o&&(A=o)):"string"==typeof n&&(A=n)):"object"==typeof e?(j=e,"number"==typeof n?(x=n,"string"==typeof o&&(A=o)):"string"==typeof n&&(A=n)):"number"==typeof e?(x=e,"string"==typeof n&&(A=n)):"string"==typeof e&&(A=e),$.ajaxSetup({url:t,timeout:x}),this.count=0,this.debug=function(t){return s=t!==!1,i},this.defaultArray=j,this["delete"]=function(t,e,n,o,r){return t&&O(t,"DELETE",E,e,n,o,r),i},this.disableCache=function(){return E=!1,i},this.disableLoader=function(){return R=!1,i},this.enableCache=function(){return E=!0,i},this.enableLoader=function(){return R=!0,i},this.get=function(t,e,n,o,r){return t&&O(t,"GET",E,e,n,o,r),i},this.loaderSize=function(t){return $("#twist-ajax-loader").length&&$("#twist-ajax-loader").attr("class","").addClass(t),A=t,i},this.onfail=function(t){var e="string"==typeof t&&""!==t?t:"An unexpected AJAX response was given";return l(e),i},this.patch=function(t,e,n,o,r){return t&&O(t,"PATCH",E,e,n,o,r),i},this.post=function(t,e,n,o,r){return t&&O(t,"POST",E,e,n,o,r),i},this.put=function(t,e,n,o,r){return t&&O(t,"PUT",E,e,n,o,r),i},$(document).ready(function(){$("#twist-ajax-loader").length||$("body").prepend('<div id="twist-ajax-loader" class="'+A+'"><span id="twist-ajax-loader-count"></span><span id="twist-ajax-loader-size"></span></div>')}),!0};return e}throw"Twist AJAX requires jQuery to run"}catch(n){window.twistdebug?window.twistdebug.error(n):window.console&&window.console.log&&console.error(n)}});